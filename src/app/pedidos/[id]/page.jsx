'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport Image from 'next/image';\n\nexport default function PedidoDetalhes({ params }) {\n  const [pedido, setPedido] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [mensagem, setMensagem] = useState('');\n\n  useEffect(() => {\n    const fetchPedido = async () => {\n      try {\n        const response = await fetch(`/api/pedidos/${params.id}`);\n        const data = await response.json();\n        \n        if (response.ok) {\n          setPedido(data);\n        } else {\n          setMensagem('Pedido não encontrado');\n        }\n      } catch (error) {\n        console.error('Erro ao carregar pedido:', error);\n        setMensagem('Erro ao carregar pedido');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchPedido();\n  }, [params.id]);\n\n  const getStatusColor = (status) => {\n    const colors = {\n      pendente: 'bg-yellow-100 text-yellow-800',\n      processando: 'bg-blue-100 text-blue-800',\n      enviado: 'bg-purple-100 text-purple-800',\n      entregue: 'bg-green-100 text-green-800',\n      cancelado: 'bg-red-100 text-red-800'\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n\n  const getStatusLabel = (status) => {\n    const labels = {\n      pendente: 'Pendente',\n      processando: 'Processando',\n      enviado: 'Enviado',\n      entregue: 'Entregue',\n      cancelado: 'Cancelado'\n    };\n    return labels[status] || status;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-xl\">Carregando pedido...</div>\n      </div>\n    );\n  }\n\n  if (!pedido) {\n    return (\n      <div className=\"min-h-screen flex flex-col items-center justify-center\">\n        <div className=\"text-xl mb-4\">Pedido não encontrado</div>\n        <Link href=\"/perfil\" className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600\">\n          ← Voltar ao Perfil\n        </Link>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Navigation */}\n      <nav className=\"bg-white border-b py-4\">\n        <div className=\"max-w-7xl mx-auto px-4\">\n          <div className=\"flex items-center space-x-2 text-sm\">\n            <Link href=\"/\" className=\"text-blue-600 hover:text-blue-800\">\n              Início\n            </Link>\n            <span>›</span>\n            <Link href=\"/perfil\" className=\"text-blue-600 hover:text-blue-800\">\n              Meu Perfil\n            </Link>\n            <span>›</span>\n            <span className=\"text-gray-500\">Pedido #{pedido.id}</span>\n          </div>\n        </div>\n      </nav>\n\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\n        <div className=\"bg-white rounded-lg shadow-lg overflow-hidden\">\n          {/* Header do Pedido */}\n          <div className=\"bg-blue-600 text-white p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h1 className=\"text-2xl font-bold\">Pedido #{pedido.id}</h1>\n                <p className=\"text-blue-100\">Realizado em {new Date(pedido.criadoEm).toLocaleDateString()}</p>\n              </div>\n              <div className=\"text-right\">\n                <div className={`inline-block px-3 py-1 rounded-full text-sm font-semibold ${\n                  getStatusColor(pedido.status)\n                } bg-opacity-20 text-white border border-white`}>\n                  {getStatusLabel(pedido.status)}\n                </div>\n                <p className=\"text-2xl font-bold mt-2\">R$ {pedido.total.toFixed(2)}</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Mensagem */}\n          {mensagem && (\n            <div className=\"bg-red-50 border-l-4 border-red-400 p-4\">\n              <p className=\"text-red-700\">{mensagem}</p>\n            </div>\n          )}\n\n          <div className=\"p-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n              {/* Detalhes do Pedido */}\n              <div className=\"lg:col-span-2 space-y-6\">\n                {/* Status Timeline */}\n                <div>\n                  <h2 className=\"text-lg font-semibold mb-4\">Status do Pedido</h2>\n                  <div className=\"flex items-center space-x-4\">\n                    {[\n                      { status: 'pendente', label: 'Pendente' },\n                      { status: 'processando', label: 'Processando' },\n                      { status: 'enviado', label: 'Enviado' },\n                      { status: 'entregue', label: 'Entregue' }\n                    ].map((step, index) => {\n                      const isActive = [\n                        'pendente',\n                        'processando',\n                        'enviado',\n                        'entregue'\n                      ].indexOf(pedido.status) >= index;\n                      \n                      const isCurrent = pedido.status === step.status;\n                      \n                      return (\n                        <div key={step.status} className=\"flex items-center\">\n                          <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ${\n                            isCurrent\n                              ? 'bg-blue-600 text-white'\n                              : isActive\n                              ? 'bg-green-600 text-white'\n                              : 'bg-gray-200 text-gray-600'\n                          }`}>\n                            {isActive && !isCurrent ? '✓' : index + 1}\n                          </div>\n                          <span className={`ml-2 text-sm ${\n                            isActive ? 'text-gray-900 font-medium' : 'text-gray-500'\n                          }`}>\n                            {step.label}\n                          </span>\n                          {index < 3 && (\n                            <div className={`w-12 h-0.5 ml-4 ${\n                              isActive ? 'bg-green-600' : 'bg-gray-200'\n                            }`}></div>\n                          )}\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n\n                {/* Itens do Pedido */}\n                <div>\n                  <h2 className=\"text-lg font-semibold mb-4\">Itens do Pedido</h2>\n                  <div className=\"space-y-4\">\n                    {pedido.itens.map((item) => (\n                      <div key={item.id} className=\"flex items-center space-x-4 border-b pb-4\">\n                        {/* Imagem */}\n                        <div className=\"w-16 h-16 bg-gray-200 rounded-lg overflow-hidden flex-shrink-0\">\n                          {item.produto.imagemUrl ? (\n                            <Image\n                              src={item.produto.imagemUrl}\n                              alt={item.produto.nome}\n                              width={64}\n                              height={64}\n                              className=\"w-full h-full object-cover\"\n                              onError={(e) => {\n                                e.target.src = '/images/placeholder.jpg';\n                              }}\n                            />\n                          ) : (\n                            <div className=\"w-full h-full flex items-center justify-center text-gray-400\">\n                              <svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                <path fillRule=\"evenodd\" d=\"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z\" clipRule=\"evenodd\" />\n                              </svg>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Detalhes */}\n                        <div className=\"flex-1\">\n                          <h3 className=\"font-semibold text-gray-900\">\n                            <Link\n                              href={`/produtos/${item.produto.id}`}\n                              className=\"hover:text-blue-600\"\n                            >\n                              {item.produto.nome}\n                            </Link>\n                          </h3>\n                          <div className=\"flex items-center space-x-4 text-sm text-gray-500\">\n                            <span className=\"bg-blue-100 text-blue-800 px-2 py-1 rounded\">\n                              {item.produto.liga?.sigla}\n                            </span>\n                            {item.produto.time && (\n                              <span className=\"bg-gray-100 text-gray-800 px-2 py-1 rounded\">\n                                {item.produto.time.nome}\n                              </span>\n                            )}\n                            <span>Cor: {item.produto.cor?.nome}</span>\n                            <span>Tamanho: {item.produto.tamanho?.nome}</span>\n                          </div>\n                        </div>\n\n                        {/* Quantidade e Preço */}\n                        <div className=\"text-right\">\n                          <div className=\"text-lg font-semibold text-gray-900\">\n                            R$ {(item.preco * item.quantidade).toFixed(2)}\n                          </div>\n                          <div className=\"text-sm text-gray-500\">\n                            {item.quantidade}x R$ {item.preco.toFixed(2)}\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              {/* Informações do Cliente */}\n              <div className=\"space-y-6\">\n                {/* Cliente */}\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-3\">Cliente</h3>\n                  <div className=\"bg-gray-50 rounded-lg p-4\">\n                    <p className=\"font-medium\">{pedido.usuario.nome}</p>\n                    <p className=\"text-sm text-gray-600\">{pedido.usuario.email}</p>\n                    {pedido.usuario.telefone && (\n                      <p className=\"text-sm text-gray-600\">{pedido.usuario.telefone}</p>\n                    )}\n                  </div>\n                </div>\n\n                {/* Endereço de Entrega */}\n                {pedido.usuario.endereco && (\n                  <div>\n                    <h3 className=\"text-lg font-semibold mb-3\">Endereço de Entrega</h3>\n                    <div className=\"bg-gray-50 rounded-lg p-4\">\n                      <p>{pedido.usuario.endereco.endereco}, {pedido.usuario.endereco.numero}</p>\n                      {pedido.usuario.endereco.complemento && (\n                        <p>{pedido.usuario.endereco.complemento}</p>\n                      )}\n                      <p>{pedido.usuario.endereco.bairro}</p>\n                      <p>{pedido.usuario.endereco.cidade} - {pedido.usuario.endereco.estado.uf}</p>\n                      <p>CEP: {pedido.usuario.endereco.cep}</p>\n                    </div>\n                  </div>\n                )}\n\n                {/* Forma de Pagamento */}\n                {pedido.formaPagamento && (\n                  <div>\n                    <h3 className=\"text-lg font-semibold mb-3\">Forma de Pagamento</h3>\n                    <div className=\"bg-gray-50 rounded-lg p-4\">\n                      <p className=\"font-medium\">\n                        {pedido.formaPagamento.tipo === 'cartao_credito' ? 'Cartão de Crédito' : 'Cartão de Débito'}\n                      </p>\n                      <p className=\"text-sm text-gray-600\">\n                        {pedido.formaPagamento.bandeiraCartao} {pedido.formaPagamento.numeroCartao}\n                      </p>\n                    </div>\n                  </div>\n                )}\n\n                {/* Resumo Financeiro */}\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-3\">Resumo</h3>\n                  <div className=\"bg-gray-50 rounded-lg p-4 space-y-2\">\n                    <div className=\"flex justify-between\">\n                      <span>Subtotal:</span>\n                      <span>R$ {pedido.total.toFixed(2)}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span>Frete:</span>\n                      <span className=\"text-green-600\">Grátis</span>\n                    </div>\n                    <div className=\"border-t pt-2\">\n                      <div className=\"flex justify-between font-semibold text-lg\">\n                        <span>Total:</span>\n                        <span>R$ {pedido.total.toFixed(2)}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Ações */}\n                <div className=\"space-y-3\">\n                  {pedido.status === 'pendente' && (\n                    <button className=\"w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700\">\n                      Cancelar Pedido\n                    </button>\n                  )}\n                  \n                  <Link\n                    href=\"/perfil\"\n                    className=\"block w-full bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 text-center\"\n                  >\n                    Voltar ao Perfil\n                  </Link>\n                  \n                  <Link\n                    href=\"/produtos\"\n                    className=\"block w-full bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 text-center\"\n                  >\n                    Continuar Comprando\n                  </Link>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"